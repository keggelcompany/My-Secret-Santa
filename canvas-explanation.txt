# Canvas Generation - Secret Santa Wrapped Card

## Ubicaci√≥n del C√≥digo

El canvas se genera en el archivo:
üìÅ `d:\CONTRA-HolidayChallenge-Design\client\src\pages\EventView.tsx`

## Funci√≥n Principal

La funci√≥n que genera el canvas se llama `generateWrappedCard()` y se encuentra en las l√≠neas 149-224.

## C√≥mo Funciona

1. **Referencia del Canvas** (l√≠nea 47):
   ```tsx
   const canvasRef = useRef<HTMLCanvasElement>(null);
   ```

2. **Elemento Canvas en el DOM** (l√≠nea 264):
   ```tsx
   <canvas ref={canvasRef} className="hidden" />
   ```
   El canvas est√° oculto con `className="hidden"` porque solo se usa para generar la imagen

3. **Funci√≥n de Generaci√≥n** (l√≠neas 149-224):
   ```tsx
   const generateWrappedCard = () => {
     // Obtiene referencia al canvas
     const canvas = canvasRef.current;
     const ctx = canvas.getContext("2d");
     
     // Define dimensiones
     canvas.width = 800;
     canvas.height = 600;
     
     // Dibuja background con gradiente
     // Dibuja c√≠rculos decorativos
     // Dibuja texto con informaci√≥n del evento
     // Genera descarga del PNG
   }
   ```

## Contenido Actual del Canvas

El canvas incluye:
- **Background**: Gradiente verde (holiday-green ‚Üí verde oscuro)
- **C√≠rculos decorativos**: Rojo y dorado
- **Texto incluido**:
  - "Secret Santa Wrapped" (t√≠tulo principal)
  - Nombre del evento
  - Nombre del participante
  - "You gifted to: [nombre]"
  - "Wishlist items created: [n√∫mero]"
  - "Total participants: [n√∫mero]"
  - "Event Status: Completed" (si el evento termin√≥)
  - "Happy Holidays!" (despedida)
  - "My Secret Santa" (firma)

## C√≥mo Reemplazar con Canvas Personalizado

### Opci√≥n 1: Modificar el Canvas Existente

Edita la funci√≥n `generateWrappedCard()` en `EventView.tsx` (l√≠neas 149-224):

```tsx
const generateWrappedCard = () => {
  const canvas = canvasRef.current;
  if (!canvas || !joinData || !matchData) return;
  
  const ctx = canvas.getContext("2d");
  if (!ctx) return;

  canvas.width = 800;  // Cambia las dimensiones si quieres
  canvas.height = 600;

  // AQU√ç ES DONDE PERSONALIZAS:
  
  // 1. Cambiar el background
  ctx.fillStyle = "#TU_COLOR";
  ctx.fillRect(0, 0, 800, 600);
  
  // 2. Agregar im√°genes
  const img = new Image();
  img.src = "/ruta/a/tu/imagen.png";
  img.onload = () => {
    ctx.drawImage(img, x, y, width, height);
  };
  
  // 3. Cambiar fuentes y textos
  ctx.fillStyle = "white";
  ctx.font = "bold 48px TuFuente, sans-serif";
  ctx.textAlign = "center";
  ctx.fillText("Tu Texto Aqu√≠", 400, 80);
  
  // 4. Agregar m√°s elementos decorativos
  // C√≠rculos, l√≠neas, formas, etc.
  
  // El resto permanece igual (descarga)
  const link = document.createElement("a");
  link.download = "nombre-archivo.png";
  link.href = canvas.toDataURL("image/png");
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}
```

### Opci√≥n 2: Usar una Imagen de Plantilla

```tsx
const generateWrappedCard = () => {
  const canvas = canvasRef.current;
  const ctx = canvas.getContext("2d");
  
  canvas.width = 800;
  canvas.height = 600;

  // Cargar tu plantilla personalizada
  const template = new Image();
  template.src = "/figmaAssets/wrapped-card-template.png";
  
  template.onload = () => {
    // Dibuja la plantilla como fondo
    ctx.drawImage(template, 0, 0, 800, 600);
    
    // Luego agrega el texto din√°mico encima
    ctx.fillStyle = "white";
    ctx.font = "24px Jost";
    ctx.textAlign = "center";
    ctx.fillText(joinData.participant.name, 400, 200);
    ctx.fillText(`Gifted to: ${matchData.name}`, 400, 280);
    
    // Contin√∫a con la descarga...
    const link = document.createElement("a");
    link.download = "secret-santa-wrapped.png";
    link.href = canvas.toDataURL("image/png");
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  };
}
```

### Opci√≥n 3: Biblioteca de Dise√±o (html2canvas o similar)

Si quieres dise√±ar el canvas como HTML/CSS y convertirlo:

1. Instala: `npm install html2canvas`
2. Crea tu dise√±o en HTML/CSS
3. Convierte a canvas:

```tsx
import html2canvas from 'html2canvas';

const generateWrappedCard = async () => {
  const element = document.getElementById('wrapped-card-design');
  const canvas = await html2canvas(element);
  const link = document.createElement("a");
  link.download = "wrapped-card.png";
  link.href = canvas.toDataURL("image/png");
  link.click();
}
```

## Datos Disponibles para Personalizaci√≥n

Dentro de `generateWrappedCard()` tienes acceso a:
- `joinData.event` - Informaci√≥n del evento (nombre, host, estado, etc.)
- `joinData.participant` - Informaci√≥n del participante actual
- `matchData` - Informaci√≥n de la persona a quien le toca regalar
- `wishlistItems` - Array de items en la wishlist
- `allParticipants` - Array de todos los participantes (si es host)

## Ejemplo Completo de Personalizaci√≥n

```tsx
const generateWrappedCard = () => {
  const canvas = canvasRef.current;
  if (!canvas || !joinData || !matchData) return;
  
  const ctx = canvas.getContext("2d");
  if (!ctx) return;

  // Dimensiones personalizadas
  canvas.width = 1080;
  canvas.height = 1920;

  // Background con imagen
  const bg = new Image();
  bg.src = "/figmaAssets/custom-background.jpg";
  bg.onload = () => {
    ctx.drawImage(bg, 0, 0, 1080, 1920);
    
    // Overlay semitransparente
    ctx.fillStyle = "rgba(31, 76, 52, 0.8)";
    ctx.fillRect(0, 0, 1080, 1920);
    
    // Logo personalizado
    const logo = new Image();
    logo.src = "/figmaAssets/logo-1.png";
    logo.onload = () => {
      ctx.drawImage(logo, 490, 100, 100, 100);
      
      // Texto personalizado
      ctx.fillStyle = "#FFD700";
      ctx.font = "bold 72px Jost";
      ctx.textAlign = "center";
      ctx.fillText("üéÑ Secret Santa 2024 üéÑ", 540, 300);
      
      ctx.fillStyle = "white";
      ctx.font = "48px Jost";
      ctx.fillText(joinData.event.name, 540, 400);
      
      ctx.font = "36px Jost";
      ctx.fillText(`${joinData.participant.name}'s Summary`, 540, 500);
      
      ctx.font = "32px Jost";
      ctx.fillText(`You gifted to: ${matchData.name}`, 540, 700);
      ctx.fillText(`Wishlist items: ${wishlistItems.length}`, 540, 800);
      
      // Descarga
      const link = document.createElement("a");
      link.download = `${joinData.event.name}-wrapped.png`;
      link.href = canvas.toDataURL("image/png");
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    };
  };
}
```

## Consejos

1. **Prueba primero**: Cambia solo el background o un texto para probar
2. **Usa im√°genes locales**: Coloca tus im√°genes en `/public/figmaAssets/`
3. **Fuentes**: Aseg√∫rate de que la fuente est√© cargada en `index.css`
4. **Dimensiones**: Ajusta canvas.width y canvas.height seg√∫n tu dise√±o
5. **Coordenadas**: Usa console.log para encontrar las posiciones exactas
6. **Preview**: Puedes quitar `className="hidden"` temporalmente para ver el canvas

## Recursos √ötiles

- Canvas API: https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API
- Dibujar im√°genes: https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/drawImage
- Texto en canvas: https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/fillText
